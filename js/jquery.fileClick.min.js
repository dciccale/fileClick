/* jQuery fileClick 1.5 | @tdecs | under the MIT license */
(function(c){c.fn.fileClick=function(j){var d=c.extend({},c.fn.fileClick.defaults,j);return this.each(function(g){function j(){var a=c(this).val().match(/[^\/\\]+$/)[0],b;if(b=d.allowDuplicates){b=f.fileNames;for(var e=b.length,k=!1;e--&&!k;)k=b[e]==a;b=k}b?alert(d.alertMsg):(f.add(a),b=d.itemTemplate,b=b.replace("{FileName}",a),a=m.getInstance().unbind(".fc").attr({id:d.inputID+g+"_"+f.fileNames.length,name:d.inputName+g+"[]"}).css({top:-3E3}),b=c(b).append(a),c.data(b.find(".fc-rm-btn")[0],"item",b),q.append(b),l.is(":visible")&&l.hide());h.removeClass(d.hoverClass);n()}var e=c(this),h=e.find(".fc-attach-btn"),p=e.find(".fc-input-container"),l=e.find(".fc-no-attachments"),q=e.find(".fc-upload-list");p.css({width:h[0].offsetWidth,height:h[0].offsetHeight});var f={fileNames:[],add:function(a){this.fileNames.push(a)},remove:function(a){this.fileNames.splice(a-1,1)}};e.delegate(d.itemTag,"removeFile.fc",function(){var a=c(this);f.remove(a.index());a.remove();f.fileNames.length||l.show()}).delegate(".fc-rm-btn","click.fc",function(a){a.preventDefault();c.data(this,"item").trigger("removeFile.fc")});var m={setInstance:function(a){this.newInput=a},getInstance:function(){return this.newInput}},n,e=function(){var a=c('<input type="file" class="'+d.inputDefaultClass+'" id="'+d.inputID+g+'" name="'+d.inputName+g+'[]" />');a.bind("mouseover.fc mouseout.fc",function(){h.toggleClass(d.hoverClass)}).bind("change.fc",j);p.html(a);m.setInstance(a)};e();n=e})};c.fn.fileClick.defaults={hoverClass:"fc-upload-btn-hover",itemTemplate:'<li><a href="#" class="fc-rm-btn">X</a>{FileName}</li>',inputID:"inputID",inputName:"files",itemTag:"li",inputDefaultClass:"fc-file-input",allowDuplicates:!1,duplicatesMessage:"File already added"}})(jQuery);
