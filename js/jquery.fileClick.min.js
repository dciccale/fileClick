// jQuery fileClick v1.4 | Author: Denis Ciccale (dciccale@gmail.com) | under the MIT and GPL licenses
(function(a){a.fn.fileClick=function(b){var c=a.extend({},a.fn.fileClick.defaults,b);return this.each(function(h){var d=a(this),m=d.find(".jAttachDocument"),p=d.find(".jFileInputContainer"),j=d.find(".jNoAttachments"),q=d.find(".jUploadList");p.css({width:m[0].offsetWidth,height:m[0].offsetHeight});var n={FileNames:[],Add:function(i){this.FileNames.push(i)},Remove:function(i){this.FileNames.splice(i-1,1)},Count:function(){return this.FileNames.length},Names:function(){return this.FileNames}};function l(){var i=a(this).val().match(/[^\/\\]+$/)[0];if(c.ShowAlertMsg&&o(i)){alert(c.AlertMsg)}else{f(i)}m.removeClass(c.HoverClass);k()}function f(s){var r,i;n.Add(s);r=c.ItemTemplate;r=r.replace("{FileName}",s);i=g.getInstance().unbind(".fileClick").attr({id:c.InputID+h+"_"+n.Count(),name:c.InputName+h+"[]"}).css({top:-3000});r=a(r).append(i);a.data(r.find(".jRemoveFile")[0],"item",r);q.append(r);if(j.is(":visible")){j.hide()}}function e(){var i=a(this);n.Remove(i.index());i.remove();if(!n.Count()){j.show()}}d.delegate(c.ItemTag,"removeFile.fileClick",e).delegate(".jRemoveFile","click.fileClick",function(i){i.preventDefault();a.data(this,"item").trigger("removeFile.fileClick")});function o(u){var r=n.Names(),s=n.Count(),t=false;while(s--&&!t){t=r[s]==u}return t}var g={setInstance:function(i){this.newInput=i},getInstance:function(){return this.newInput}};var k=(function(){function i(){var r=a("<input type='file' class='"+c.InputDefaultClass+"' id='"+c.InputID+h+"' name='"+c.InputName+h+"[]' />");g.setInstance(r);r.bind("mouseover.fileClick mouseout.fileClick",function(){m.toggleClass(c.HoverClass)}).bind("change.fileClick",l);p.html(r)}i();return i})()})};a.fn.fileClick.defaults={HoverClass:"jUploadButtonHover",ItemTemplate:'<li><a href="#" class="jRemoveFile">X</a>{FileName}</li>',InputID:"InputID",InputName:"Files",ItemTag:"li",InputDefaultClass:"jInputFile",ShowAlertMsg:true,AlertMsg:"Ya existe un fichero con ese nombre"}})(jQuery);